---
import menuMobile from "../../assets/navbar/menu-mobile.svg";
import menuOpen from "../../assets/navbar/menu-open.svg";
import Logo from "./Logo.astro";

const { navigationItems } = Astro.props;
---

<div
  class="md:hidden flex flex-col w-full relative bg-[#ffffff1a] rounded-xl border border-solid border-[#0000000f]"
>
  <div class="flex items-center justify-between w-full p-1">
    <Logo />
    <button
      id="mobile-menu-toggle"
      class="flex-col items-start relative flex-[0_0_auto] bg-[#13151a] rounded-lg overflow-hidden border border-solid border-[#26282c] cursor-pointer"
      aria-label="Toggle menu"
      type="button"
      aria-expanded="false"
    >
      <img
        id="menu-icon"
        class="w-full h-full"
        alt=""
        src={menuMobile.src}
        data-menu-closed={menuMobile.src}
        data-menu-open={menuOpen.src}
        role="presentation"
      />
    </button>
  </div>

  <div
    id="mobile-menu"
    class="hidden w-full mt-2 p-3 bg-white rounded-lg shadow-md transition-all duration-300 ease-in-out"
  >
    <nav class="flex flex-col space-y-3">
      {
        navigationItems.map((item) => (
          <a
            href={item.href}
            class="py-2 px-3 text-gray-800 hover:bg-gray-100 hover:text-blue-600 rounded-lg transition-colors mobile-menu-link"
          >
            {item.label}
          </a>
        ))
      }
    </nav>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const toggleButton = document.getElementById("mobile-menu-toggle");
    const mobileMenu = document.getElementById("mobile-menu");
    const menuIcon = document.getElementById("menu-icon");
    const menuLinks = document.querySelectorAll(".mobile-menu-link");

    function closeMenu() {
      if (toggleButton && mobileMenu && menuIcon) {
        toggleButton.setAttribute("aria-expanded", "false");
        mobileMenu.classList.add("hidden");
        (menuIcon as HTMLImageElement).src =
          menuIcon.getAttribute("data-menu-closed") || "";
      }
    }

    function openMenu() {
      if (toggleButton && mobileMenu && menuIcon) {
        toggleButton.setAttribute("aria-expanded", "true");
        mobileMenu.classList.remove("hidden");
        (menuIcon as HTMLImageElement).src =
          menuIcon.getAttribute("data-menu-open") || "";
      }
    }

    if (toggleButton && mobileMenu && menuIcon) {
      toggleButton.addEventListener("click", () => {
        const isExpanded =
          toggleButton.getAttribute("aria-expanded") === "true";

        if (isExpanded) {
          closeMenu();
        } else {
          openMenu();
        }
      });

      menuLinks.forEach((link) => {
        link.addEventListener("click", (e) => {
          closeMenu();
        });
      });
    }
  });
</script>
